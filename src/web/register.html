<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>register page</title>
<script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>
<script language="javascript">
/*$("#file").change(function (event) {*/
var filechange=function(event){
    var files = event.target.files, file;
    if (files && files.length > 0) {
        // 获取目前上传的文件
        file = files[0];// 文件大小校验的动作
        if(file.size > 1024 * 1024 * 2) {
            alert('图片大小不能超过 2MB!');
            return false;
        }
        // 获取 window 的 URL 工具
        var URL = window.URL || window.webkitURL;
        // 通过 file 生成目标 url
        var imgURL = URL.createObjectURL(file);
        //用attr将img的src属性改成获得的url
        $("#img-change").attr("src",imgURL);
        // 使用下面这句可以在内存中释放对此 url 的伺服，跑了之后那个 URL 就无效了
        // URL.revokeObjectURL(imgURL);
    }
};
</script>
</head>
<body>
	<center>
		<h4>register page</h4>
		<form action="/doRegister.do" name="frm" method="post" enctype="multipart/form-data">
			<p>
				username: <input type="text" name="name" />
			</p>
			<p>
				password: <input type="password" name="password" />
			</p>
			<p>
				profile: <input type="file" name="profile" accept="image/gif,image/jpeg,image/jpg,image/png" onchange="filechange(event)"/>
				<img width="200px" height="200px" id="img-change"/>
			</p>
			<p>
				nickname: <input type="text" name="nickname" />
			</p>
			<input type="submit" value="submit" />
		</form>
	</center>
</body>
</html>